<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f4f6f9;
            font-family: Arial, sans-serif;
        }

        .container {
            margin-top: 50px;
        }

        .weather-box {
            background-color: #ffffff;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        .weather-info {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .weather-info img {
            width: 80px;
            margin-right: 20px;
        }

        h4 {
            color: #333;
            font-size: 24px;
            font-weight: 600;
        }

        p {
            color: #555;
            font-size: 18px;
            margin: 5px 0;
        }

        #weatherChart {
            margin-top: 30px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .form-control,
        .btn {
            border-radius: 50px;
        }

        .btn-primary {
            background: linear-gradient(45deg, lightcyan);
            border: none;
        }

        .btn-primary:hover {
            background: linear-gradient(45deg, #0056b3, #007bff);
        }

        .form-label {
            font-weight: 600;
            color: #333;
        }

        .weather-result {
            background-color: #f1f4f9;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .error-message {
            color: #ff4d4d;
            font-size: 18px;
            font-weight: 600;
        }

        .card {
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            background-color: lightcyan;
            color: white;
            font-weight: bold;
            border-radius: 10px 10px 0 0;
        }

        .image-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .centered-image {
            width: 35%;
            max-width: 35%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <div class="image-container">
            <img src="images/weather.gif" alt="Weather Icon" class="centered-image">
        </div>
        <h2 class="text-center mb-4">Weather Information</h2>
        <div class="card">
            <div class="card-header">
                <h4 class="text-center">Enter City to Get Weather Data</h4>
            </div>
            <div class="card-body">
                <form id="weatherForm" class="mt-4">
                    <div class="mb-3">
                        <label for="city" class="form-label">Search City Name</label>
                        <input type="text" id="city" class="form-control" placeholder="e.g., London" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg w-100">Get Weather</button>
                </form>
            </div>
        </div>

        <div id="weatherResult" class="weather-result mt-4"></div>

        <canvas id="weatherChart"></canvas>
    </div>

    <script>
        document.getElementById("weatherForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const city = document.getElementById("city").value;
            const apiKey = "6cd6a70861da468f08217dacb3fd20a9";
            const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric`;

            try {
                // Fetching forecast data
                const response = await axios.get(url);
                const data = response.data;

                // Extracting weather icon and details for current data
                const weatherIcon = `http://openweathermap.org/img/wn/${data.list[0].weather[0].icon}.png`;

                document.getElementById("weatherResult").innerHTML = `
                    <div class="weather-info">
                        <img src="${weatherIcon}" alt="Weather Icon">
                        <div>
                            <h4>Weather in ${data.city.name}</h4>
                            <p><strong>Temperature:</strong> ${data.list[0].main.temp}°C</p>
                            <p><strong>Condition:</strong> ${data.list[0].weather[0].description}</p>
                            <p><strong>Humidity:</strong> ${data.list[0].main.humidity}%</p>
                        </div>
                    </div>
                `;

                // Prepare data for the line chart
                const labels = data.list.slice(0, 8).map(forecast => {
                    const date = new Date(forecast.dt * 1000);
                    return date.toLocaleString(); // Formatting the timestamp into a readable date & time
                });

                const temperatures = data.list.slice(0, 8).map(forecast => forecast.main.temp);

                // Create the line chart with the first 8 data points
                new Chart(document.getElementById('weatherChart'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: `Temperature in ${data.city.name}`,
                            data: temperatures,
                            borderColor: '#FF6347',
                            backgroundColor: 'rgba(255, 99, 71, 0.2)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: false,
                                ticks: {
                                    callback: function (value) { return value + "°C"; }
                                }
                            }
                        }
                    }
                });

            } catch (error) {
                document.getElementById("weatherResult").innerHTML = `
                    <p class="error-message">Error fetching weather data. Please try again.</p>
                `;
            }
        });
    </script>
</body>

</html>
